<?xml version="1.0" encoding="UTF-8"?>
<action xmlns="http://vmware.com/vco/action" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://vmware.com/vco/action http://vmware.com/vco/action" version="1.0.0" api-version="8.0.0">
  <display-name>Get Next Available IP</display-name>
  <description>Gets the next available IP address from Infoblox IPAM</description>
  <module>com.acme.infoblox</module>

  <input>
    <param name="network" type="string">
      <description>Network CIDR (e.g., 10.1.0.0/24)</description>
    </param>
  </input>

  <output>
    <param name="ipAddress" type="string">
      <description>Next available IP address</description>
    </param>
  </output>

  <script><![CDATA[
// Infoblox IPAM - get next available IP
// Get Infoblox server connection
var infoblox = System.getModule("com.vmware.library.infoblox").getServer();

// Get next available IP from network
ipAddress = infoblox.getNextAvailableIP(network);

System.log("Retrieved next available IP from Infoblox: " + ipAddress);
System.log("  Network: " + network);

if (!ipAddress) {
  throw "No available IP addresses in network: " + network;
}

return ipAddress;
]]></script>
</action>
